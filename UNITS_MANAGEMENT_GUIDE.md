# 🏢 事業單位管理完整指南

## ✨ 功能概述

完整的事業單位管理系統，包含：
- ✅ 事業單位名稱設定
- ✅ 是否為分散型選擇
- ✅ 地址設定
- ✅ 醫生、護理師、其他人員名單管理
- ✅ 12個月時數分配設定
- ✅ 新增、編輯、刪除功能
- ✅ 資料自動同步到 Google Sheets

---

## 📊 Google Sheets 設定

### 必要工作表

系統會在您的 Google Sheets 中建立「**事業單位詳細**」工作表，結構如下：

#### 欄位說明（共 42 欄）

| 欄位範圍 | 內容 | 說明 |
|---------|------|------|
| A | 事業單位名稱 | 必填，例如：台北診所 |
| B | 是否為分散型 | 是/否 |
| C | 地址 | 例如：台北市信義區 |
| D | 醫生姓名 | 每行一個，以換行分隔 |
| E | 護理師姓名 | 每行一個，以換行分隔 |
| F | 其他人員姓名 | 每行一個，以換行分隔 |
| G-I | 一月時數 | G:醫生 H:護理師 I:其他 |
| J-L | 二月時數 | J:醫生 K:護理師 L:其他 |
| M-O | 三月時數 | M:醫生 N:護理師 O:其他 |
| ... | ... | 每月3欄，共36欄 |
| AK-AM | 十二月時數 | AK:醫生 AL:護理師 AM:其他 |

---

## 🚀 如何使用

### 步驟 1：新增事業單位

1. 登入系統後，點擊「🏢 事業單位」頁籤
2. 填寫表單：

```
事業單位名稱 *：台北診所
是否為分散型：否
地址：台北市信義區信義路100號

醫生姓名（每行一個）：
王醫師
李醫師

護理師姓名（每行一個）：
陳護理師
林護理師

其他醫療人員（每行一個）：
張技師
劉行政
```

3. 填寫每月時數分配：

```
一月：
  醫生時數：160
  護理師時數：180
  其他人員時數：120

二月：
  醫生時數：144
  護理師時數：162
  其他人員時數：108
  
... （其他月份）
```

4. 點擊「💾 儲存事業單位」
5. 完成！✅

---

### 步驟 2：查看已建檔事業單位

在頁面下方會顯示「已建檔事業單位」列表，包含：
- 事業單位名稱
- 是否為分散型
- 地址
- 年度總時數（自動計算）
- 操作按鈕（編輯/刪除）

---

### 步驟 3：編輯事業單位

1. 在列表中找到要編輯的事業單位
2. 點擊「✏️ 編輯」按鈕
3. 表單會自動填入該事業單位的資料
4. 修改需要的欄位
5. 點擊「💾 儲存事業單位」
6. 完成更新！✅

---

### 步驟 4：刪除事業單位

1. 在列表中找到要刪除的事業單位
2. 點擊「🗑️ 刪除」按鈕
3. 確認刪除
4. 完成！✅

⚠️ **注意**：刪除操作無法復原，請謹慎操作！

---

### 步驟 5：清空表單（新增下一個）

1. 點擊「🆕 新增事業單位」按鈕
2. 表單會清空
3. 可以輸入新的事業單位資料

---

## 💡 使用範例

### 範例 1：診所設定

```
事業單位名稱：台北診所
是否為分散型：否
地址：台北市信義區信義路100號

醫生姓名：
王醫師
李醫師
張醫師

護理師姓名：
陳護理師
林護理師
黃護理師
吳護理師

每月時數：
一月：醫生 480h / 護理師 720h / 其他 0h
二月：醫生 432h / 護理師 648h / 其他 0h
...
十二月：醫生 480h / 護理師 720h / 其他 0h

年度總時數：
醫生：5280h
護理師：7920h
其他：0h
```

---

### 範例 2：分散型醫療單位

```
事業單位名稱：桃園醫療群
是否為分散型：是
地址：桃園市多個據點

醫生姓名：
王醫師
李醫師

護理師姓名：
陳護理師
林護理師

其他醫療人員：
張技師
劉行政人員

每月時數：
一月：醫生 320h / 護理師 480h / 其他 200h
二月：醫生 288h / 護理師 432h / 其他 180h
...
```

---

## 📋 表單欄位詳解

### 1. 事業單位名稱 *（必填）

- 輸入診所或醫療單位的名稱
- 此名稱會出現在排班表單的下拉選單中
- 範例：`台北診所`、`新竹分院`、`桃園醫療群`

### 2. 是否為分散型

- **否**：單一據點（預設）
- **是**：多據點分散型

用途：標示該單位是否有多個分點或據點

### 3. 地址

- 事業單位的地址
- 可選填
- 範例：`台北市信義區信義路100號`

### 4. 醫生姓名

- 每行輸入一位醫生的姓名
- 按 Enter 換行
- 範例：
  ```
  王醫師
  李醫師
  張醫師
  ```

### 5. 護理師姓名

- 每行輸入一位護理師的姓名
- 按 Enter 換行
- 範例：
  ```
  陳護理師
  林護理師
  黃護理師
  ```

### 6. 其他醫療人員

- 其他工作人員，例如：技師、行政人員等
- 每行一個
- 範例：
  ```
  張技師
  劉行政
  ```

### 7. 每月時數分配

為每個月分別設定三種人員的工作時數：

#### 醫生時數
- 該月份醫生的總工作時數
- 數字，單位：小時

#### 護理師時數
- 該月份護理師的總工作時數
- 數字，單位：小時

#### 其他人員時數
- 該月份其他人員的總工作時數
- 數字，單位：小時

**自動計算**：系統會自動計算年度總時數並顯示在列表中

---

## 🔢 時數計算範例

### 月份天數與時數對應

| 月份 | 天數 | 平均每日8小時 | 備註 |
|------|------|--------------|------|
| 一月 | 31天 | 248小時 | 按實際工作日計算 |
| 二月 | 28/29天 | 224/232小時 | 平年/閏年 |
| 三月 | 31天 | 248小時 | |
| 四月 | 30天 | 240小時 | |
| 五月 | 31天 | 248小時 | |
| 六月 | 30天 | 240小時 | |
| 七月 | 31天 | 248小時 | |
| 八月 | 31天 | 248小時 | |
| 九月 | 30天 | 240小時 | |
| 十月 | 31天 | 248小時 | |
| 十一月 | 30天 | 240小時 | |
| 十二月 | 31天 | 248小時 | |

### 實際案例計算

#### 案例 1：全職醫生（每週40小時）

```
一月（31天，4.4週）：40h × 4.4 = 176小時
二月（28天，4週）：40h × 4 = 160小時
...
年度總時數：約 2080小時
```

#### 案例 2：兼職護理師（每週20小時）

```
一月：20h × 4.4 = 88小時
二月：20h × 4 = 80小時
...
年度總時數：約 1040小時
```

---

## ⚠️ 注意事項

### 1. 資料儲存

- 所有資料會自動儲存到 Google Sheets
- 工作表名稱：「**事業單位詳細**」
- 首次儲存時會自動建立工作表

### 2. 資料格式

- 人員姓名使用換行符號分隔
- 時數必須是數字（可以為 0）
- 事業單位名稱不可重複

### 3. 權限要求

- 必須已登入 Google 帳號
- 必須已授權 Google Sheets API 權限
- 必須已設定正確的 Sheet ID

### 4. 資料同步

- 新增/編輯後會立即寫入 Google Sheets
- 刪除後會立即從 Google Sheets 移除
- 排班下拉選單會自動更新

---

## 🔧 常見問題

### Q1：為什麼儲存時出現錯誤？

**可能原因：**
1. 未授權 Google Sheets 權限
2. Sheet ID 設定錯誤
3. 網路連線問題

**解決方式：**
1. 確認已在「⚙️ 設定」頁籤填入 Sheet ID
2. 檢查是否已授權 Google Sheets 權限
3. 重新整理頁面並重新登入

---

### Q2：事業單位列表是空的？

**可能原因：**
- 尚未新增任何事業單位

**解決方式：**
1. 填寫表單
2. 點擊「💾 儲存事業單位」
3. 列表會立即顯示

---

### Q3：時數可以填 0 嗎？

**答**：可以！如果某個月份沒有該類人員排班，可以填 0 或留空（系統會自動視為 0）

---

### Q4：可以修改已儲存的事業單位嗎？

**答**：可以！點擊「✏️ 編輯」按鈕，修改後再點擊「💾 儲存事業單位」即可。

---

### Q5：刪除事業單位後可以恢復嗎？

**答**：無法恢復！刪除操作是永久的，請務必確認後再執行。建議定期備份 Google Sheets。

---

### Q6：年度總時數是如何計算的？

**答**：系統會自動將 12 個月的時數相加，公式為：
```
年度總時數 = 一月時數 + 二月時數 + ... + 十二月時數
```

---

### Q7：排班時看不到我剛新增的事業單位？

**可能原因：**
- 排班下拉選單尚未更新

**解決方式：**
- 點擊排班表單中「事業單位」欄位旁的「🔄」按鈕
- 或重新整理頁面

---

### Q8：可以在 Google Sheets 中直接編輯嗎？

**不建議！**雖然技術上可行，但：
- 可能破壞資料格式
- 系統不會即時同步
- 建議統一在系統中操作

---

## 📈 使用流程圖

```
┌─────────────────────────────────────┐
│  登入系統                           │
└────────────┬────────────────────────┘
             ↓
┌─────────────────────────────────────┐
│  點擊「🏢 事業單位」頁籤           │
└────────────┬────────────────────────┘
             ↓
┌─────────────────────────────────────┐
│  填寫表單                           │
│  • 事業單位名稱（必填）            │
│  • 是否為分散型                     │
│  • 地址                             │
│  • 人員名單                         │
│  • 12個月時數                       │
└────────────┬────────────────────────┘
             ↓
┌─────────────────────────────────────┐
│  點擊「💾 儲存事業單位」           │
└────────────┬────────────────────────┘
             ↓
┌─────────────────────────────────────┐
│  ✅ 儲存成功！                      │
│  • 資料寫入 Google Sheets           │
│  • 列表自動更新                     │
│  • 排班下拉選單自動更新             │
└─────────────────────────────────────┘
```

---

## 🎯 快速開始檢查清單

完成以下步驟，開始管理事業單位：

- [ ] 已登入 Google 帳號
- [ ] 已在「⚙️ 設定」填入 Sheet ID
- [ ] 已授權 Google Sheets 權限
- [ ] 已點擊「🏢 事業單位」頁籤
- [ ] 填寫事業單位名稱
- [ ] 選擇是否為分散型
- [ ] 填寫地址（選填）
- [ ] 填寫醫生名單
- [ ] 填寫護理師名單
- [ ] 填寫其他人員名單（選填）
- [ ] 填寫 12 個月的時數分配
- [ ] 點擊「💾 儲存事業單位」
- [ ] 確認列表中出現新的事業單位
- [ ] 測試排班表單中可以選擇該事業單位

---

## 📚 相關文檔

- [Google Sheets 設定指南](GOOGLE_SHEETS_SETUP_GUIDE.md)
- [快速開始指南](QUICK_START_WEB_SHEETS.md)
- [匯出與統計報表](EXPORT_AND_STATS_GUIDE.md)
- [問題排除](TROUBLESHOOTING_LOGIN.md)

---

**最後更新**：2025-11-03  
**版本**：3.0.0  
**新增**：完整事業單位管理功能

---

**現在就開始管理您的事業單位吧！** 🚀



