# 📊 Google Sheets 試算表設定指南

## 🎯 概述

本指南教您如何在 Google Sheets 中建立完整的排班管理試算表，包含**排班資料**和**事業單位**兩個工作表。

---

## 📋 必要工作表

您的 Google Sheets 需要包含以下兩個工作表：

1. **排班資料**（儲存排班記錄）
2. **事業單位**（儲存事業單位清單）

---

## 📝 工作表 1：排班資料

### 建立步驟

#### 步驟 1：建立/重新命名工作表

1. 在 Google Sheets 底部，確保有一個工作表
2. 右鍵點擊工作表標籤
3. 選擇「重新命名」
4. 輸入：**排班資料**
5. 按 Enter

#### 步驟 2：設定標題列（第 1 列）

在第 1 列輸入以下標題：

| A | B | C | D | E | F | G | H |
|---|---|---|---|---|---|---|---|
| 日期 | 開始時間 | 結束時間 | 事業單位 | 人員名單 | 地點 | 顏色 | 備註 |

#### 步驟 3：資料格式說明

從第 2 列開始輸入排班資料，格式如下：

| 欄位 | 格式 | 範例 | 必填 |
|------|------|------|------|
| **A: 日期** | YYYY-MM-DD | 2025-11-05 | ✅ 是 |
| **B: 開始時間** | HH:MM | 09:00 | ✅ 是 |
| **C: 結束時間** | HH:MM | 17:00 | ✅ 是 |
| **D: 事業單位** | 文字 | 台北診所 | ✅ 是 |
| **E: 人員名單** | 文字（逗號分隔）| 王醫師, 李護理師 | ✅ 是 |
| **F: 地點** | 文字 | 台北市信義區 | ❌ 否 |
| **G: 顏色** | 顏色代碼 | #FF5733 | ❌ 否 |
| **H: 備註** | 文字 | 日班 | ❌ 否 |

#### 步驟 4：範例資料

```
| 日期       | 開始時間 | 結束時間 | 事業單位 | 人員名單        | 地點         | 顏色    | 備註   |
|-----------|---------|---------|---------|---------------|-------------|---------|--------|
| 2025-11-05| 09:00   | 17:00   | 台北診所 | 王醫師, 李護理師 | 台北市信義區 | #FF5733 | 日班   |
| 2025-11-05| 14:00   | 22:00   | 新竹診所 | 張醫師          | 新竹市東區   | #33C1FF | 下午班 |
| 2025-11-06| 09:00   | 17:00   | 台中診所 | 陳護理師, 林技師 | 台中市西區   | #4CAF50 | 日班   |
```

---

## 🏢 工作表 2：事業單位

### 建立步驟

#### 步驟 1：新增工作表

1. 點擊 Google Sheets 左下角的 **「+」** 按鈕
2. 新工作表會出現
3. 右鍵點擊新工作表標籤
4. 選擇「重新命名」
5. 輸入：**事業單位**
6. 按 Enter

#### 步驟 2：設定標題列（第 1 列）

在第 1 列輸入以下標題：

| A | B | C | D |
|---|---|---|---|
| 事業單位名稱 | 地址 | 聯絡電話 | 備註 |

#### 步驟 3：資料格式說明

從第 2 列開始輸入事業單位資料：

| 欄位 | 格式 | 範例 | 必填 |
|------|------|------|------|
| **A: 事業單位名稱** | 文字 | 台北診所 | ✅ 是 |
| **B: 地址** | 文字 | 台北市信義區信義路100號 | ❌ 否 |
| **C: 聯絡電話** | 文字 | 02-12345678 | ❌ 否 |
| **D: 備註** | 文字 | 週一至週五營業 | ❌ 否 |

#### 步驟 4：範例資料

```
| 事業單位名稱 | 地址                    | 聯絡電話      | 備註           |
|-------------|------------------------|--------------|---------------|
| 台北診所    | 台北市信義區信義路100號 | 02-12345678  | 週一至週五營業 |
| 新竹診所    | 新竹市東區光復路50號    | 03-87654321  | 週六上午營業   |
| 台中診所    | 台中市西區台灣大道200號 | 04-23456789  | 24小時營業     |
```

---

## 🎨 完整範例截圖（文字版）

### 工作表：排班資料

```
     A          B        C        D        E                F            G        H
┌─────────────┬────────┬────────┬────────┬────────────────┬────────────┬────────┬──────┐
│    日期     │開始時間│結束時間│事業單位│   人員名單     │    地點    │ 顏色   │ 備註 │
├─────────────┼────────┼────────┼────────┼────────────────┼────────────┼────────┼──────┤
│ 2025-11-05  │ 09:00  │ 17:00  │台北診所│王醫師,李護理師 │台北市信義區│#FF5733 │ 日班 │
│ 2025-11-05  │ 14:00  │ 22:00  │新竹診所│張醫師          │新竹市東區  │#33C1FF │下午班│
│ 2025-11-06  │ 09:00  │ 17:00  │台中診所│陳護理師,林技師 │台中市西區  │#4CAF50 │ 日班 │
└─────────────┴────────┴────────┴────────┴────────────────┴────────────┴────────┴──────┘
```

### 工作表：事業單位

```
     A              B                      C               D
┌──────────────┬─────────────────────────┬──────────────┬─────────────────┐
│事業單位名稱  │        地址             │  聯絡電話    │     備註        │
├──────────────┼─────────────────────────┼──────────────┼─────────────────┤
│  台北診所    │台北市信義區信義路100號  │ 02-12345678  │週一至週五營業   │
│  新竹診所    │新竹市東區光復路50號     │ 03-87654321  │週六上午營業     │
│  台中診所    │台中市西區台灣大道200號  │ 04-23456789  │24小時營業       │
└──────────────┴─────────────────────────┴──────────────┴─────────────────┘
```

---

## ⚙️ 在排班系統中的設定

### 步驟 1：取得 Sheet ID

1. 開啟您的 Google Sheets
2. 查看網址列，格式如下：
   ```
   https://docs.google.com/spreadsheets/d/{SHEET_ID}/edit
   ```
3. 複製 `{SHEET_ID}` 部分
   - 範例：`10aBWB3NFHyW2Vnx0shKywtuoRxt8bRRQN0_rmfBZGWA`

### 步驟 2：在系統中設定

1. 開啟排班系統：
   ```
   http://localhost:8000/shift_management_system_sheets_full.html
   ```

2. 點擊「⚙️ 設定」頁籤

3. 填入設定：
   - **Google API 用戶端 ID**：您的 Client ID
   - **Google Sheets ID**：剛才複製的 Sheet ID
   - **排班資料範圍**：`排班資料!A2:H`（預設值）

4. 點擊「💾 儲存設定」

5. 點擊「✅ 測試連線」確認

---

## 🔄 如何使用事業單位功能

### 方法 1：自動載入

當您載入排班資料時，系統會自動載入事業單位清單。

### 方法 2：手動重新載入

1. 點擊「✏️ 排班管理」頁籤
2. 在新增排班表單中，點擊「事業單位」欄位旁的「🔄」按鈕
3. 系統會重新從 Google Sheets 載入事業單位

### 方法 3：從事業單位頁籤載入

1. 點擊「🏢 事業單位」頁籤
2. 點擊「🔄 重新載入事業單位」按鈕
3. 查看載入的事業單位列表

---

## ⚠️ 常見問題

### Q1：為什麼看不到事業單位？

**檢查清單：**
- ✅ 確認 Google Sheets 中有「事業單位」工作表
- ✅ 確認工作表名稱完全相同（包含大小寫）
- ✅ 確認第 1 列有標題列
- ✅ 確認第 2 列開始有資料
- ✅ 確認 A 欄（事業單位名稱）不是空白

### Q2：載入事業單位時出現錯誤

**可能原因：**
1. **工作表不存在**：確認已建立「事業單位」工作表
2. **權限問題**：確認已授權 Google Sheets API 存取權限
3. **格式錯誤**：確認第 1 列為標題列，資料從第 2 列開始

**解決方式：**
```
1. 開啟 Google Sheets
2. 確認「事業單位」工作表存在
3. 檢查資料格式
4. 回到系統，重新點擊「🔄」按鈕
```

### Q3：新增事業單位後，系統沒有更新

**解決方式：**
1. 在 Google Sheets 中新增事業單位
2. 回到排班系統
3. 點擊「事業單位」欄位旁的「🔄」按鈕
4. 或到「🏢 事業單位」頁籤點擊「🔄 重新載入事業單位」

### Q4：可以在系統中新增事業單位嗎？

目前版本需要直接在 Google Sheets 中管理事業單位。

**原因：**
- 保持資料源統一
- 方便批量管理
- 避免同步問題

### Q5：事業單位的其他欄位（地址、電話）有用嗎？

目前系統主要使用「事業單位名稱」欄位。其他欄位：
- **地址、電話、備註**：供您參考管理使用
- 未來版本可能會整合到系統中顯示

---

## 📊 資料範圍說明

### 排班資料範圍

```
排班資料!A2:H
```

- **工作表名稱**：排班資料
- **起始儲存格**：A2（跳過第 1 列標題）
- **結束欄位**：H（共 8 欄）
- **列數**：自動讀取到最後一列

### 事業單位範圍

```
事業單位!A2:D
```

- **工作表名稱**：事業單位
- **起始儲存格**：A2（跳過第 1 列標題）
- **結束欄位**：D（共 4 欄）
- **列數**：自動讀取到最後一列

---

## 🎯 快速設定檢查清單

完成以下步驟，打勾確認：

### Google Sheets 設定

- [ ] 建立 Google Sheets 試算表
- [ ] 建立「排班資料」工作表
- [ ] 在「排班資料」第 1 列設定標題：日期 | 開始時間 | 結束時間 | 事業單位 | 人員名單 | 地點 | 顏色 | 備註
- [ ] 建立「事業單位」工作表
- [ ] 在「事業單位」第 1 列設定標題：事業單位名稱 | 地址 | 聯絡電話 | 備註
- [ ] 在「事業單位」工作表中新增至少一個事業單位

### 系統設定

- [ ] 複製 Google Sheets 的 Sheet ID
- [ ] 在排班系統「⚙️ 設定」頁籤填入 Client ID
- [ ] 在排班系統「⚙️ 設定」頁籤填入 Sheet ID
- [ ] 點擊「💾 儲存設定」
- [ ] 點擊「✅ 測試連線」
- [ ] 登入 Google 帳號
- [ ] 授權 Google Sheets API 存取權限

### 測試功能

- [ ] 點擊「🏢 事業單位」頁籤
- [ ] 點擊「🔄 重新載入事業單位」
- [ ] 確認事業單位列表正確顯示
- [ ] 點擊「✏️ 排班管理」頁籤
- [ ] 點擊「➕ 新增排班」
- [ ] 確認「事業單位」下拉選單中有選項

---

## 💡 使用技巧

### 技巧 1：批量新增事業單位

在 Google Sheets 中，您可以：
1. 複製貼上多筆事業單位資料
2. 使用拖曳填充快速建立
3. 從 Excel 匯入資料

### 技巧 2：使用資料驗證

在 Google Sheets 中設定資料驗證：
1. 選取「排班資料」工作表的 D 欄（事業單位）
2. 點擊「資料」→「資料驗證」
3. 條件：「清單來源範圍」→ 選擇「事業單位!A2:A」
4. 這樣可以確保排班時只能選擇已存在的事業單位

### 技巧 3：顏色管理

建議為不同事業單位設定不同顏色：
- 台北診所：`#FF5733`（紅色）
- 新竹診所：`#33C1FF`（藍色）
- 台中診所：`#4CAF50`（綠色）

### 技巧 4：資料備份

定期下載 Google Sheets：
1. 點擊「檔案」→「下載」
2. 選擇「Microsoft Excel (.xlsx)」
3. 儲存到本地電腦作為備份

---

## 📚 相關文檔

- [快速開始指南](QUICK_START_WEB_SHEETS.md)
- [Google API 設定](WEB_GOOGLE_SHEETS_SETUP.md)
- [問題排除](TROUBLESHOOTING_LOGIN.md)
- [匯出與統計報表](EXPORT_AND_STATS_GUIDE.md)

---

**最後更新**：2025-11-03  
**版本**：2.0.0  
**新增**：事業單位工作表設定說明

---

**現在就開始設定您的 Google Sheets 吧！** 📊✨



