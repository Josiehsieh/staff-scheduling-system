# 🧪 階段1功能快速測試指南

**版本**：v4.0.0  
**測試時間**：約 5-10 分鐘  
**目的**：驗證所有階段1新功能正常運作

---

## 📋 測試清單

- [ ] 假日設定與顯示
- [ ] 月曆點擊日期新增排班
- [ ] 時間自動計算（+2小時）
- [ ] 假日在不同月份顯示
- [ ] 國家切換功能

---

## 🚀 開始測試

### 準備工作

1. **啟動本地伺服器**
   ```bash
   # PowerShell
   cd C:\Users\josie\staff-scheduling-system
   python -m http.server 8000
   
   # 或使用 Node.js
   npx http-server -p 8000
   ```

2. **開啟瀏覽器**
   ```
   http://localhost:8000/shift_management_system_sheets_full.html
   ```

3. **登入系統**
   - 使用 Google 帳號登入
   - 確認已載入排班資料

---

## 測試1：假日設定與顯示 ⏱️ 2分鐘

### 步驟

```
1. 點擊「⚙️ 設定」頁籤
2. 找到「🗓️ 假日設定」區塊
3. 確認預設國家：🇹🇼 台灣
4. 確認「顯示假日」已勾選
5. 點擊「🔄 重新載入假日」
6. 觀察狀態訊息
```

### ✅ 預期結果

```
✓ 顯示「載入假日中...」（藍色）
✓ 然後顯示「成功載入 X 個假日」（綠色）
✓ 3秒後訊息消失
```

### 🔍 檢查控制台（F12）

```javascript
// 應該看到類似訊息：
從API載入 TW 2025 假日：12 個
```

### ❌ 如果失敗

**問題：顯示「載入假日失敗」**
```
→ 檢查網路連線
→ 確認防火牆未阻擋 date.nager.at
→ 嘗試更換瀏覽器
```

**問題：沒有任何訊息**
```
→ 檢查 JavaScript 錯誤（F12 控制台）
→ 重新載入頁面（Ctrl+F5）
```

---

## 測試2：月曆顯示假日 ⏱️ 2分鐘

### 步驟

```
1. 點擊「📅 排班檢視」頁籤
2. 確認當前月份（2025年11月）
3. 觀察月曆上的日期
```

### ✅ 預期結果

**台灣11月假日（範例）：**
```
無國定假日
（如有補班日，可能顯示調整放假）
```

**測試12月（有假日）：**
```
1. 點擊「下個月 ▶」切換到12月
2. 查看 12/25（聖誕節，如適用）
```

### 🎨 視覺檢查

假日日期應該有：
```
✓ 紅色漸層背景
✓ 左側紅色邊框
✓ 紅色假日標籤（顯示假日名稱）
```

**範例畫面：**
```
┌─────────────────────┐
│ 25        聖誕節 🏷️  │ ← 紅色背景
├─────────────────────┤
│ (排班事件...)        │
└─────────────────────┘
```

### 🔍 檢查元素（F12）

```html
<!-- 假日的 HTML 應該類似： -->
<div class="calendar-day clickable holiday">
    <div class="calendar-day-header">25</div>
    <div class="holiday-badge">聖誕節</div>
    <!-- 排班事件... -->
</div>
```

### ❌ 如果失敗

**問題：沒有紅色背景**
```
→ 檢查「顯示假日」是否勾選
→ 確認已成功載入假日資料
→ 檢查 CSS 是否正確載入
```

**問題：假日資料不準確**
```
→ 假日資料來自 API，可能有延遲
→ 手動重新載入假日
→ 重要假日請額外確認官方資料
```

---

## 測試3：點擊日期新增排班 ⏱️ 3分鐘

### 步驟

```
1. 在「📅 排班檢視」頁籤
2. 找一個空白日期（例如：今天之後的某一天）
3. 將滑鼠移到該日期上方
4. 觀察懸停效果
5. 點擊該日期
```

### ✅ 預期結果

**懸停效果：**
```
✓ 日期方格向上移動（2px）
✓ 出現陰影效果
✓ 邊框變為藍紫色
✓ 滑鼠游標變為手指 (cursor: pointer)
```

**點擊後：**
```
✓ 自動切換到「✏️ 排班管理」頁籤
✓ 自動開啟「新增排班」表單
✓ 日期欄位已自動填入點擊的日期
✓ 頁面捲動到表單位置
```

### 📸 測試範例

```
點擊：2025-11-15

結果：
- 頁籤切換 ✓
- 表單開啟 ✓
- 日期欄位：2025-11-15 ✓
- 其他欄位：空白 ✓
```

### ❌ 如果失敗

**問題：點擊沒有反應**
```
→ 確認點擊的是日期方格（不是週標題）
→ 檢查 JavaScript 錯誤（F12）
→ 重新載入頁面
```

**問題：日期沒有自動填入**
```
→ 檢查 onCalendarDayClick() 函數
→ 確認 shiftDate input 元素存在
```

---

## 測試4：時間自動計算 ⏱️ 2分鐘

### 步驟

```
1. 在「✏️ 排班管理」的新增表單中
2. 點擊「開始時間」輸入框
3. 選擇時間：09:00
4. 觀察「結束時間」欄位
```

### ✅ 預期結果

```
輸入開始時間：09:00
自動設定結束時間：11:00
```

### 📊 測試多種時間

| 開始時間 | 預期結束時間 | 說明 |
|---------|------------|------|
| 09:00 | 11:00 | 一般情況 |
| 14:00 | 16:00 | 下午時段 |
| 18:00 | 20:00 | 晚上時段 |
| 22:00 | 00:00 | 午夜 |
| 23:00 | 01:00 | 跨日 |
| 23:30 | 01:30 | 跨日（含分鐘）|

### 🔧 進階測試

```
1. 輸入開始時間：10:00 → 結束：12:00 ✓
2. 手動修改結束時間：13:00 → 保持 13:00 ✓
3. 再次修改開始時間：11:00 → 結束：13:00 ✓
```

### ❌ 如果失敗

**問題：結束時間沒有自動填入**
```
→ 確認已初始化（檢查 initializeApp）
→ 使用時間選擇器而非手動輸入
→ 檢查 setupTimeAutoCalculation() 函數
```

**問題：跨日計算錯誤**
```
→ 檢查計算邏輯
→ 確認處理 endHours >= 24 的情況
```

---

## 測試5：國家切換 ⏱️ 3分鐘

### 步驟

```
1. 進入「⚙️ 設定」頁籤
2. 在「國家/地區假日」下拉選單
3. 選擇：🇯🇵 日本 (Japan)
4. 觀察狀態訊息
5. 返回「📅 排班檢視」
6. 觀察假日變化
```

### ✅ 預期結果

```
切換國家：
✓ 顯示「假日設定已儲存」
✓ 顯示「成功載入 X 個假日」
✓ 月曆重新渲染

日本假日範例（11月）：
- 11/3: 文化の日 (Culture Day)
- 11/23: 勤労感謝の日 (Labor Thanksgiving Day)
```

### 🌍 測試多個國家

**推薦測試順序：**
```
1. 🇹🇼 台灣 → 檢查農曆新年等
2. 🇯🇵 日本 → 檢查文化節日
3. 🇺🇸 美國 → 檢查感恩節、聖誕節
4. 🇨🇳 中國 → 檢查國慶節等
```

### 🔍 檢查快取（F12 → Application → Local Storage）

```javascript
// 應該看到：
holidays_TW_2025: "[...假日資料...]"
holidays_JP_2025: "[...假日資料...]"
holidays_US_2025: "[...假日資料...]"
```

### ❌ 如果失敗

**問題：切換後假日沒變**
```
→ 手動點擊「🔄 重新載入假日」
→ 清除瀏覽器快取
→ 重新載入頁面
```

**問題：某些國家載入失敗**
```
→ 該國家可能不在 API 支援列表
→ 檢查控制台錯誤訊息
→ 嘗試其他主要國家
```

---

## 測試6：假日顯示開關 ⏱️ 1分鐘

### 步驟

```
1. 確認月曆上有假日顯示（紅色）
2. 進入「⚙️ 設定」頁籤
3. 取消勾選「在月曆上顯示假日」
4. 返回「📅 排班檢視」
5. 觀察變化
```

### ✅ 預期結果

```
取消勾選：
✓ 假日紅色背景消失
✓ 假日標籤消失
✓ 恢復正常白色背景

重新勾選：
✓ 假日標記立即恢復
✓ 不需重新載入資料（使用快取）
```

### ❌ 如果失敗

**問題：開關無效**
```
→ 檢查 saveHolidaySettings() 函數
→ 確認 localStorage 儲存正確
→ 重新載入頁面測試持久性
```

---

## 測試7：切換年份假日 ⏱️ 2分鐘

### 步驟

```
1. 在「📅 排班檢視」
2. 當前月份：2025年11月
3. 連續點擊「下個月 ▶」
4. 切換到 2026年1月
5. 觀察控制台（F12）
```

### ✅ 預期結果

**切換到2026年時：**
```javascript
// 控制台應顯示：
從API載入 TW 2026 假日：12 個
// 或
從快取載入 TW 2026 假日：12 個
```

**月曆顯示：**
```
✓ 2026年1月1日：元旦（紅色）
✓ 其他2026年假日正確顯示
```

### 🔍 檢查 LocalStorage

```javascript
// 應該有兩個年份的快取：
holidays_TW_2025: "[...]"
holidays_TW_2026: "[...]"
```

### ❌ 如果失敗

**問題：切換年份後假日錯誤**
```
→ 檢查 changeMonth() 函數
→ 確認年份變更檢測邏輯
→ 手動重新載入假日
```

---

## 🎯 完整功能測試（整合）

### 情境：完整排班流程 ⏱️ 5分鐘

```
目標：在12月25日（假日）新增一個排班

步驟1: 設定國家為台灣（或包含聖誕節的國家）
步驟2: 切換到12月
步驟3: 確認12/25顯示為紅色（假日）
步驟4: 點擊12/25日期
     → 自動跳轉到排班管理
     → 日期已填入：2025-12-25
步驟5: 輸入開始時間：09:00
     → 結束時間自動：11:00
步驟6: 填寫其他資料（單位、人員、地點）
步驟7: 儲存排班
步驟8: 返回月曆檢視
步驟9: 確認12/25有排班事件，且仍保持紅色背景
```

### ✅ 預期結果

```
✓ 假日正確顯示
✓ 點擊日期正常
✓ 時間自動計算
✓ 排班成功儲存
✓ 月曆正確顯示排班在假日上
```

---

## 📊 測試結果記錄

### 測試環境

```
□ 作業系統：Windows / macOS / Linux
□ 瀏覽器：Chrome / Edge / Firefox / Safari
□ 瀏覽器版本：_____________
□ 測試日期：_____________
```

### 測試結果

| 測試項目 | 通過 | 失敗 | 備註 |
|---------|------|------|------|
| 1. 假日設定與顯示 | ☐ | ☐ | |
| 2. 月曆顯示假日 | ☐ | ☐ | |
| 3. 點擊日期新增排班 | ☐ | ☐ | |
| 4. 時間自動計算 | ☐ | ☐ | |
| 5. 國家切換 | ☐ | ☐ | |
| 6. 假日顯示開關 | ☐ | ☐ | |
| 7. 切換年份假日 | ☐ | ☐ | |
| 8. 完整流程測試 | ☐ | ☐ | |

### 總結

```
✅ 通過項目：_____ / 8
❌ 失敗項目：_____ / 8
⚠️ 需改進項目：_____

整體評價：□ 優秀  □ 良好  □ 需改進
```

---

## 🐛 常見問題快速解決

### 問題1：假日沒有顯示

```bash
解決步驟：
1. F12 打開控制台
2. 查看是否有錯誤訊息
3. 確認網路連線
4. 點擊「重新載入假日」
5. 清除瀏覽器快取（Ctrl+Shift+Del）
```

### 問題2：點擊日期無反應

```bash
解決步驟：
1. 確認點擊日期數字或方格內
2. F12 查看 JavaScript 錯誤
3. 重新載入頁面（Ctrl+F5）
4. 嘗試不同瀏覽器
```

### 問題3：時間沒有自動計算

```bash
解決步驟：
1. 使用時間選擇器（點擊輸入框）
2. 不要手動輸入文字
3. 確認格式：HH:MM（09:00）
4. 重新載入頁面
```

---

## 📈 效能測試

### 假日載入速度測試

```javascript
// 在控制台執行：
console.time('假日載入');
await loadHolidays(true);
console.timeEnd('假日載入');

// 預期結果：
首次 API 載入：1000ms - 2000ms ✓
快取讀取：<100ms ✓
```

### 月曆渲染速度測試

```javascript
// 在控制台執行：
console.time('月曆渲染');
renderCalendar();
console.timeEnd('月曆渲染');

// 預期結果：
渲染時間：<200ms ✓
```

---

## ✅ 測試完成檢查表

```
□ 所有測試項目已執行
□ 測試結果已記錄
□ 發現的問題已記錄
□ 整體功能正常運作
□ 可以開始正式使用
```

---

## 🎓 下一步

### 測試通過？

**🎉 恭喜！您已成功驗證階段1所有功能！**

```
→ 開始使用智慧月曆排班系統
→ 查閱 PHASE1_USER_GUIDE.md 了解更多技巧
→ 期待階段2的更多功能！
```

### 測試失敗？

```
→ 查閱 TROUBLESHOOTING 章節
→ 檢查瀏覽器控制台錯誤
→ 回報問題並提供詳細資訊
```

---

**祝測試順利！** 🧪✅🚀



