# 📅 階段1功能使用指南 - 智慧月曆排班系統

**版本**：v4.0.0  
**更新日期**：2025-11-03  
**狀態**：✅ 階段1完成

---

## 🎉 新功能一覽

階段1為您的排班系統帶來5大智慧化功能：

1. ✅ **點擊日期新增排班** - 月曆上直接點擊，快速新增
2. ✅ **時間自動計算** - 開始時間自動+2小時到結束時間
3. ✅ **假日顯示（紅色）** - 月曆自動標記假日
4. ✅ **多國假日支援** - 15個國家/地區可選
5. ✅ **假日快取** - 智慧快取，載入快速

---

## 📋 功能詳細說明

### 1️⃣ 點擊日期新增排班

#### 🎯 功能說明

在月曆檢視頁面，直接點擊任何日期，系統會：
- ✅ 自動切換到「排班管理」頁籤
- ✅ 開啟新增排班表單
- ✅ 自動填入您點擊的日期
- ✅ 自動捲動到表單位置

#### 📸 使用方式

```
步驟1: 進入「📅 排班檢視」頁籤
步驟2: 在月曆上找到要排班的日期
步驟3: 直接點擊該日期方格
步驟4: 系統自動跳轉並開啟表單
步驟5: 日期已自動填入，繼續填寫其他資料
```

#### 💡 使用技巧

- **快速排班**：看到空白日期，直接點擊立即新增
- **假日排班**：紅色日期也能點擊，系統會提醒是假日
- **檢視排班**：已有排班的日期，點擊後可查看詳情

#### ⚠️ 注意事項

- 點擊日期會切換頁籤，請先儲存其他正在編輯的資料
- 如果點擊的是排班事件本身，會開啟編輯而非新增

---

### 2️⃣ 時間自動計算（+2小時）

#### 🎯 功能說明

輸入開始時間後，系統自動計算並填入結束時間（開始時間 + 2小時）

#### 📸 使用方式

```
步驟1: 在排班表單中選擇「開始時間」
步驟2: 例如輸入：09:00
步驟3: 系統自動設定「結束時間」為：11:00
步驟4: 如需調整，手動修改結束時間即可
```

#### 💡 智慧計算

**自動處理跨日**
```
開始時間：23:00
結束時間：01:00 (自動計算)
```

**常見時段範例**
```
09:00 → 11:00
14:00 → 16:00
18:00 → 20:00
22:00 → 00:00
```

#### ⚠️ 注意事項

- 自動計算僅在「首次輸入」或「修改」開始時間時觸發
- 如果不是2小時，可手動修改結束時間
- 跨日排班（如23:00-01:00）會正確處理

---

### 3️⃣ 假日顯示（紅色標記）

#### 🎯 功能說明

月曆自動標記國定假日：
- 🎨 紅色漸層背景
- 🏷️ 顯示假日名稱標籤
- 🔴 左側紅色邊框

#### 📸 視覺效果

```
┌────────────────────┐
│ 1         假日：元旦│  ← 紅色背景
├────────────────────┤
│ 09:00 台北診所      │
└────────────────────┘
```

#### 💡 假日來源

- **API服務**：Nager.Date (免費、可靠)
- **更新頻率**：每年自動更新
- **涵蓋範圍**：支援15個國家/地區

#### 🌍 支援的國家/地區

| 國家/地區 | 代碼 | 假日數量（約）|
|-----------|------|--------------|
| 🇹🇼 台灣 | TW | 11-12天 |
| 🇨🇳 中國 | CN | 11天 |
| 🇭🇰 香港 | HK | 17天 |
| 🇲🇴 澳門 | MO | 20天 |
| 🇯🇵 日本 | JP | 16天 |
| 🇰🇷 韓國 | KR | 15天 |
| 🇸🇬 新加坡 | SG | 11天 |
| 🇲🇾 馬來西亞 | MY | 5天（全國性）|
| 🇹🇭 泰國 | TH | 19天 |
| 🇻🇳 越南 | VN | 10天 |
| 🇺🇸 美國 | US | 11天 |
| 🇬🇧 英國 | GB | 8天 |
| 🇦🇺 澳洲 | AU | 8天 |
| 🇳🇿 紐西蘭 | NZ | 11天 |
| 🇨🇦 加拿大 | CA | 5天（全國性）|

---

### 4️⃣ 假日設定管理

#### 🎯 設定位置

```
⚙️ 設定 → 🗓️ 假日設定
```

#### 📸 設定選項

**國家/地區選擇**
```
下拉選單：
🇹🇼 台灣 (Taiwan)      ← 預設
🇨🇳 中國 (China)
🇭🇰 香港 (Hong Kong)
...更多
```

**顯示開關**
```
☑ 在月曆上顯示假日（紅色標記）
```

#### 🔄 更換國家

```
步驟1: 進入「⚙️ 設定」頁籤
步驟2: 找到「🗓️ 假日設定」區塊
步驟3: 在「國家/地區假日」下拉選單選擇
步驟4: 系統自動儲存並重新載入假日
步驟5: 返回月曆查看新的假日標記
```

#### 💡 使用技巧

**臨時關閉假日顯示**
```
取消勾選「在月曆上顯示假日」
→ 月曆恢復正常顯示
→ 假日資料仍保留在快取
```

**手動重新載入**
```
點擊「🔄 重新載入假日」按鈕
→ 清除快取並重新從API取得
→ 用於假日資料更新時
```

---

### 5️⃣ 假日快取機制

#### 🎯 功能說明

系統智慧快取假日資料，提升載入速度：

**快取策略**
```
首次載入 → 從API取得 → 儲存到瀏覽器
再次載入 → 從瀏覽器讀取（瞬間）
切換年份 → 自動載入新年份假日
```

#### 📊 效能提升

| 載入方式 | 時間 | 說明 |
|---------|------|------|
| 首次（API）| ~1-2秒 | 需網路連線 |
| 快取（本地）| <0.1秒 | 離線可用 |

#### 🗂️ 快取位置

```
瀏覽器 LocalStorage：
- holidays_TW_2025  ← 台灣2025年假日
- holidays_CN_2025  ← 中國2025年假日
- holidays_JP_2026  ← 日本2026年假日
...
```

#### 🧹 清除快取

**方法1：重新載入**
```
設定頁籤 → 點擊「🔄 重新載入假日」
```

**方法2：切換國家**
```
更換國家/地區 → 自動重新載入
```

**方法3：清除瀏覽器快取**
```
瀏覽器設定 → 清除網站資料
```

---

## 🎯 完整使用流程範例

### 範例1：快速新增排班

```
情境：需要在11月15日新增排班

步驟：
1. 開啟系統，進入「📅 排班檢視」
2. 在月曆上找到11月15日
3. 點擊該日期方格
   → 系統自動切換到「✏️ 排班管理」
   → 自動開啟新增表單
   → 日期已填入：2025-11-15
4. 選擇開始時間：09:00
   → 結束時間自動設定：11:00
5. 選擇事業單位、人員、地點
6. 點擊「💾 儲存排班」
7. 完成！返回月曆查看

預估時間：30秒（原本需要1-2分鐘）
```

### 範例2：檢查假日並調整排班

```
情境：檢視12月排班，避免假日衝突

步驟：
1. 進入「⚙️ 設定」
2. 確認國家設定：🇹🇼 台灣
3. 確認「顯示假日」已勾選
4. 返回「📅 排班檢視」
5. 切換到12月
   → 系統自動載入12月假日
   → 紅色標記顯示：
     ✓ 12/25 聖誕節
     ✓ 12/31 調整放假（如適用）
6. 發現12/25有排班
7. 點擊該日期的排班事件 → 編輯
8. 調整到12/26
9. 儲存

結果：避免假日排班衝突
```

### 範例3：跨國企業多國假日

```
情境：公司有台灣和香港兩地辦公室

台灣辦公室：
1. 設定 → 國家：🇹🇼 台灣
2. 月曆顯示台灣假日（11-12天）
3. 規劃台灣排班

香港辦公室：
1. 設定 → 國家：🇭🇰 香港
2. 月曆顯示香港假日（17天）
3. 規劃香港排班

提示：可使用不同瀏覽器或無痕模式
     同時開啟兩個地區的排班系統
```

---

## 💡 使用技巧總結

### ⚡ 速度提升技巧

| 原本操作 | 新方法 | 節省時間 |
|---------|--------|---------|
| 手動切換頁籤 → 點新增 → 輸入日期 | 月曆點擊日期 | ~20秒 |
| 手動計算結束時間 | 自動+2小時 | ~10秒 |
| 切換Google日曆查假日 | 自動顯示 | ~30秒 |

**總計每次排班節省：約1分鐘** ⚡

### 🎨 視覺化改進

- ✅ 假日一目了然（紅色背景）
- ✅ 日期可點擊提示（懸停效果）
- ✅ 假日名稱標籤清楚顯示

### 🔐 資料安全

- ✅ 假日資料存在瀏覽器本地
- ✅ 不佔用Google Sheets空間
- ✅ 可離線查看快取的假日

---

## ❓ 常見問題 FAQ

### Q1: 假日沒有顯示？

**可能原因：**
1. 假日顯示已關閉
2. 該國家該日期沒有假日
3. 網路連線問題

**解決方法：**
```
1. 檢查設定 → 確認「顯示假日」已勾選
2. 點擊「🔄 重新載入假日」
3. 查看瀏覽器控制台（F12）檢查錯誤
4. 確認網路連線正常
```

### Q2: 時間沒有自動計算？

**可能原因：**
1. 開始時間輸入方式錯誤
2. 瀏覽器快取問題

**解決方法：**
```
1. 使用時間選擇器（點擊輸入框）
2. 確認輸入格式：HH:MM（例如 09:00）
3. 重新載入頁面（Ctrl+F5）
4. 嘗試不同瀏覽器
```

### Q3: 點擊日期沒有反應？

**可能原因：**
1. 點擊到空白區域
2. JavaScript未載入

**解決方法：**
```
1. 確認點擊日期數字或方格內部
2. 重新載入頁面
3. 檢查瀏覽器控制台錯誤
```

### Q4: 假日資料不準確？

**說明：**
- 假日資料來自 Nager.Date API
- 可能有地區性假日未包含
- 某些國家的彈性調整放假需手動確認

**建議：**
```
重要假日請額外確認官方資料
可在排班備註中註明特殊假日
```

### Q5: 假日可以自訂嗎？

**目前狀態：**
- 階段1僅支援API提供的國定假日
- 無法自訂假日

**未來規劃：**
- 階段2可能加入自訂假日功能
- 可自行添加公司特殊假日

**暫時解決方案：**
```
在排班備註欄位註明特殊假日
或在事業單位說明中記錄
```

### Q6: 可以同時顯示多國假日嗎？

**目前狀態：**
- 只能選擇一個國家/地區
- 切換國家會替換假日顯示

**跨國企業建議：**
```
方法1: 使用不同瀏覽器分別設定
方法2: 建立多個 Google Sheets（不同地區）
方法3: 主要用一個地區，其他手動記錄
```

### Q7: 假日會自動更新嗎？

**更新機制：**
```
✅ 切換年份：自動載入新年份假日
✅ 更換國家：自動載入該國假日
❌ 假日資料本身：由API提供者更新
```

**手動更新：**
```
設定 → 點擊「🔄 重新載入假日」
清除瀏覽器快取重新載入
```

---

## 🔧 進階設定

### 關閉特定功能

**關閉假日顯示**
```javascript
// 在設定頁籤
取消勾選「在月曆上顯示假日」
```

**修改自動計算時數**
```
目前固定為 +2小時
如需修改，需編輯 HTML 檔案中的
setupTimeAutoCalculation() 函數
```

### 調整假日顯示樣式

**修改假日顏色**
```css
/* 在 HTML 檔案的 <style> 區塊找到 */
.calendar-day.holiday {
    background: linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%);
    /* 修改為您喜歡的顏色 */
}

.holiday-badge {
    background: #f44336; /* 假日標籤背景色 */
    color: white;
}
```

---

## 📱 響應式支援

所有階段1功能完全支援：

- ✅ 桌面電腦（Chrome、Edge、Firefox）
- ✅ 筆記型電腦
- ✅ 平板電腦（iPad、Android Tablet）
- ✅ 手機（iPhone、Android）

### 手機使用提示

```
點擊日期：輕觸日期方格中央
時間選擇：使用系統時間選擇器
假日顯示：標籤較小但清晰可見
```

---

## 🚀 下一步：階段2功能預告

階段1已為您的排班系統帶來智慧化基礎！

**即將到來的階段2功能：**

1. 🔲 **人員勾選** - 不用打字，直接勾選
2. 📍 **地點選擇** - 分散型單位智慧選址
3. ⏰ **剩餘時數顯示** - 即時顯示可排時數

**預計完成時間：** 2.5-3 小時

---

## 📞 技術支援

### 遇到問題？

1. 📖 查閱本文檔常見問題區
2. 🔍 查看瀏覽器控制台（F12）
3. 🔄 嘗試重新載入頁面
4. 🗑️ 清除瀏覽器快取

### 回報問題

請提供以下資訊：
- 使用的瀏覽器和版本
- 操作步驟
- 錯誤訊息截圖
- 瀏覽器控制台錯誤訊息

---

## 📊 版本資訊

**當前版本：** v4.0.0 - 階段1增強版  
**發布日期：** 2025-11-03  
**API服務：** Nager.Date (https://date.nager.at/)  
**相容性：** Chrome 90+, Edge 90+, Firefox 88+, Safari 14+

---

## 🎓 延伸閱讀

- [`CALENDAR_ENHANCEMENT_PLAN.md`](CALENDAR_ENHANCEMENT_PLAN.md) - 技術實現詳細計畫
- [`MAJOR_UPDATE_SUMMARY.md`](MAJOR_UPDATE_SUMMARY.md) - 功能複雜度分析
- [`QUICK_START_WEB_SHEETS.md`](QUICK_START_WEB_SHEETS.md) - 快速開始指南
- [`WEB_GOOGLE_SHEETS_SETUP.md`](WEB_GOOGLE_SHEETS_SETUP.md) - Google API 設定

---

**🎉 恭喜！您已掌握階段1的所有功能！**

**開始使用智慧月曆排班系統，享受更高效的排班體驗！** ⚡📅



