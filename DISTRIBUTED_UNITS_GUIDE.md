# 🏢 分散型事業單位管理指南

## ✨ 功能說明

當事業單位選擇「是否為分散型：是」時，可以新增多個分散地點，每個地點有獨立的名稱和地址。

---

## 🚀 使用方式

### 步驟 1：選擇「分散型：是」

1. 在「🏢 事業單位」頁籤中
2. 填寫事業單位名稱
3. 點擊「是否為分散型」→ 選擇「**是**」

✅ 介面會自動切換為分散地點管理模式

---

### 步驟 2：新增分散地點

當選擇「是」後，會自動新增第一個分點輸入框，包含：

```
┌─────────────────────────────────────┐
│  🗑️ 刪除                           │
│  分點名稱：台北分點                │
│  分點地址：台北市信義區信義路100號 │
└─────────────────────────────────────┘
```

每個分點有兩個欄位：
- **分點名稱**：例如「台北分點」、「信義分點」
- **分點地址**：完整地址

---

### 步驟 3：新增更多分點

點擊「➕ 新增分點」按鈕，可以新增更多分散地點。

---

### 步驟 4：刪除分點

點擊每個分點右上角的「🗑️ 刪除」按鈕，可以刪除該分點。

---

### 步驟 5：儲存

填寫完所有資料後，點擊「💾 儲存事業單位」。

⚠️ **注意**：選擇分散型時，至少要有一個分點才能儲存。

---

## 💡 使用範例

### 範例 1：醫療診所（3個分點）

```
事業單位名稱：XX醫療群
是否為分散型：是

分點 1：
  名稱：台北分點
  地址：台北市信義區信義路100號

分點 2：
  名稱：新竹分點
  地址：新竹市東區光復路50號

分點 3：
  名稱：台中分點
  地址：台中市西區台灣大道200號
```

---

### 範例 2：連鎖藥局（多個分店）

```
事業單位名稱：健康藥局
是否為分散型：是

分點 1：
  名稱：民生店
  地址：台北市松山區民生東路3段

分點 2：
  名稱：信義店
  地址：台北市信義區松仁路

分點 3：
  名稱：南港店
  地址：台北市南港區南港路
```

---

## 🔄 非分散型（單一地點）

### 選擇「分散型：否」

如果選擇「否」，只會顯示一個簡單的地址輸入欄位：

```
地址：台北市信義區信義路100號
```

---

## 📊 資料儲存方式

### Google Sheets 儲存格式

分散型的分點資料會以 JSON 格式儲存在第 D 欄：

```json
[
  {
    "name": "台北分點",
    "address": "台北市信義區信義路100號"
  },
  {
    "name": "新竹分點",
    "address": "新竹市東區光復路50號"
  }
]
```

### 欄位結構

| 欄位 | 內容 | 分散型 | 非分散型 |
|------|------|--------|----------|
| A | 事業單位名稱 | ✅ | ✅ |
| B | 是否為分散型 | 是 | 否 |
| C | 地址 | (空白) | 完整地址 |
| D | 分點資料（JSON）| JSON 陣列 | [] |
| E | 醫生名單 | ✅ | ✅ |
| F | 護理師名單 | ✅ | ✅ |
| G | 其他人員名單 | ✅ | ✅ |
| H-AQ | 12個月時數 | ✅ | ✅ |

---

## 📋 事業單位列表顯示

### 分散型顯示

在事業單位列表中，分散型單位的地址欄位會顯示所有分點：

```
┌──────────────┬──────┬────────────────────────┬────────┬────────┐
│ 事業單位名稱 │分散型│        地址            │年度時數│ 操作   │
├──────────────┼──────┼────────────────────────┼────────┼────────┤
│ XX醫療群     │✅ 是 │ 台北分點: 台北市...    │5280h   │✏️ 🗑️ │
│              │      │ 新竹分點: 新竹市...    │/7920h  │        │
│              │      │ 台中分點: 台中市...    │/0h     │        │
└──────────────┴──────┴────────────────────────┴────────┴────────┘
```

### 非分散型顯示

```
┌──────────────┬──────┬─────────────────┬────────┬────────┐
│ 事業單位名稱 │分散型│     地址        │年度時數│ 操作   │
├──────────────┼──────┼─────────────────┼────────┼────────┤
│ 台北診所     │❌ 否 │台北市信義區...  │5280h   │✏️ 🗑️ │
│              │      │                 │/7920h  │        │
│              │      │                 │/0h     │        │
└──────────────┴──────┴─────────────────┴────────┴────────┘
```

---

## ✏️ 編輯分散型事業單位

### 步驟

1. 在列表中找到分散型事業單位
2. 點擊「✏️ 編輯」
3. 系統會自動：
   - 還原所有分點資料
   - 顯示分點管理介面
   - 填入每個分點的名稱和地址
4. 可以修改、新增、或刪除分點
5. 點擊「💾 儲存事業單位」更新

---

## ⚠️ 重要提醒

### 1. 至少一個分點

選擇分散型時，**必須至少有一個分點**才能儲存。

### 2. 分點名稱建議

- 使用清楚的命名，例如：
  - ✅ 台北分點、新竹分點
  - ✅ 信義店、南港店
  - ✅ A館、B館
- 避免使用：
  - ❌ 分點1、分點2（不易識別）

### 3. 切換模式

如果從「是」切換回「否」：
- 分點資料會被隱藏
- 但不會被刪除（除非重新儲存）
- 切換回「是」時可以重新顯示

### 4. 資料完整性

每個分點的名稱和地址都可選填，但建議至少填寫其中一個。

---

## 🔄 常見操作

### 從非分散型改為分散型

```
1. 編輯該事業單位
2. 將「是否為分散型」改為「是」
3. 新增分點資料
4. 儲存
```

### 從分散型改為非分散型

```
1. 編輯該事業單位
2. 將「是否為分散型」改為「否」
3. 在「地址」欄位填入單一地址
4. 儲存
```

⚠️ 原有的分點資料會被清除！

---

## 📱 使用場景

### 適合使用分散型

- ✅ 連鎖診所（多個據點）
- ✅ 醫療群組（多個分點）
- ✅ 連鎖藥局（多個分店）
- ✅ 醫療聯盟（多個合作單位）

### 適合使用非分散型

- ✅ 單一診所
- ✅ 單一醫院
- ✅ 單一據點的醫療單位

---

## 💻 技術說明

### JSON 資料格式

分點資料使用 JSON 陣列儲存：

```json
[
  {
    "name": "分點名稱",
    "address": "分點地址"
  }
]
```

### 資料解析

- 儲存：JavaScript 物件 → JSON 字串 → Google Sheets
- 讀取：Google Sheets → JSON 字串 → JavaScript 物件

---

## ❓ 常見問題

### Q1：最多可以新增幾個分點？

**答**：理論上沒有限制，但建議不超過 20 個以保持頁面效能。

### Q2：可以只填分點名稱不填地址嗎？

**答**：可以！兩個欄位都是選填的。

### Q3：刪除分點後可以恢復嗎？

**答**：儲存前可以重新新增，儲存後就無法恢復（除非重新編輯）。

### Q4：分點順序重要嗎？

**答**：不重要，系統會按照新增順序顯示。

### Q5：可以在編輯時新增或刪除分點嗎？

**答**：可以！編輯時可以自由新增或刪除分點。

---

## 🎯 快速檢查清單

新增分散型事業單位時：

- [ ] 填寫事業單位名稱
- [ ] 選擇「是否為分散型」→「是」
- [ ] 新增至少一個分點
- [ ] 填寫每個分點的名稱
- [ ] 填寫每個分點的地址
- [ ] 填寫人員名單
- [ ] 填寫12個月時數
- [ ] 點擊「💾 儲存事業單位」
- [ ] 確認列表中顯示正確

---

## 📚 相關文檔

- [事業單位管理完整指南](UNITS_MANAGEMENT_GUIDE.md)
- [快速開始指南](UNITS_QUICK_START.md)
- [Google Sheets 設定](GOOGLE_SHEETS_SETUP_GUIDE.md)

---

**最後更新**：2025-11-03  
**版本**：3.1.0  
**新增**：分散型事業單位管理

---

**立即試用分散型功能！** 🚀



